<MyScreenManager>
    FirstScreen:
    SecondScreen:
    ThirdScreen:
    FourthScreen:
    FifthScreen:


<SelectableBox>:
    orientation: 'horizontal'
    size_hint_y: None
    height: 20

    Button:
        size_hint: 0.20, 1
        text: '+'
        background_color: (0, 1, 0, 1)
        on_release: root.on_multiple_button_click()
        font_size: sp(32)

    Label:
        text: root.text
        font_size: sp(23)
    Button:
        size_hint: 0.20, 1
        text: "x"
        background_color: (1, 0, 0, 1)
        on_release: root.on_remove_button_click()
        font_size: sp(32)
    Button
        size_hint: 0.20, 1
        text: "cart"
        background_color: (0, 0, 1, 1)
        on_release: root.on_cart_button_click()
        font_size: sp(23)

<SelectableBoxSecondScreen>
    Label:
        text: root.text
        font_size: sp(23)

<SelectableBoxThirdScreen>
    Button:
        size_hint: 0.9, 1
        text: root.text
        font_size: sp(18)
        on_release: 
            root.on_expense_click()
            app.root.current = "fifth" 
            app.root.transition.direction = 'left'
    Button:
        size_hint: 0.1, 1
        text: 'X'
        font_size: sp(18)
        background_color: (1, 0, 0, 1)
        on_release:
            root.on_remove_expense()
        
<SelectableBoxFifthScreen>
    orientation: 'horizontal'
    Label:
        text: root.name
        font_size: sp(16)
        size_hint: 0.6, 1
        text_size: self.width, None
    Label:
        size_hint: 0.1, 1
        text: root.quantity
        font_size: sp(16)
        size_hint: 0.1, 1
    Label:
        text: root.price
        font_size: sp(16)
        size_hint: 0.2, 1

<FirstScreen>:
    name: "first"
    inputbutton1: inputbutton1
    inputcontent1: inputcontent1
    outputcontent1: outputcontent1    
    inputbutton2: inputbutton2
    inputcontent2: inputcontent2    
    outputcontent2: outputcontent2
    inputbutton3: inputbutton3
    inputcontent3: inputcontent3    
    outputcontent3: outputcontent3
    inputbutton4: inputbutton4
    inputcontent4: inputcontent4    
    outputcontent4: outputcontent4

    orientation: 'vertical'

    BoxLayout:
        size_hint: 1, 1
        orientation: 'vertical'


        Label:
            text: 'Shopping List'
            size_hint: 1, 0.1
            font_size: sp(32)
        
        Label:
            id: connection_status
            size_hint: 1, 0.06
            text: "Checking..."
            color: (1, 1, 0, 1)  # yellow for checking
            font_size: sp(20)

        Tabs:
            do_default_tab: False
            tab_width : sp(150)
            
            TabbedPanelItem:
                text: 'Lidl'
                font_size: sp(25)
                canvas.after:
                    Color:
                        rgba: (0.2, 0.6, 1, 0.2) if self.state == 'down' else (0.7, 0.7, 0.7, 0.2)
                    Rectangle:
                        pos: self.pos
                        size: self.size
                        
                BoxLayout:
                    orientation:'vertical'
                    BoxLayout:
                        size_hint: 1, 0.1
                        Button:
                            id: inputbutton1
                            size_hint: 0.3, 1
                            text: 'add'
                            background_color: (0, 1, 0, 1)
                            on_release: root.add_item()
                            font_size: sp(23)

                        TextInput:
                            id: inputcontent1
                            multiline: False
                            font_size: sp(23)

                        Button:
                            size_hint: 0.8, 1
                            text: 'clear tab'
                            background_color: (1, 0, 0, 1)
                            on_release: root.clear_tab()
                            font_size: sp(25)
                
                    ListWidget:
                        id: outputcontent1
                        viewclass: 'SelectableBox'
                        orientation: 'vertical'

                        RecycleBoxLayout:
                            default_size: None, sp(50)
                            default_size_hint: 1, None
                            size_hint_y: None
                            height: self.minimum_height
                            orientation: 'vertical'

            TabbedPanelItem:
                text: 'Aldi'
                font_size: sp(25)
                canvas.after:
                    Color:
                        rgba: (0.2, 0.6, 1, 0.2) if self.state == 'down' else (0.7, 0.7, 0.7, 0.2)
                    Rectangle:
                        pos: self.pos
                        size: self.size
                BoxLayout:
                    orientation:'vertical'
                    BoxLayout:
                        size_hint: 1, 0.1
                        Button:
                            id: inputbutton2
                            size_hint: 0.3, 1
                            text: 'add'
                            background_color: (0, 1, 0, 1)
                            on_release: root.add_item()
                            font_size: sp(23)

                        TextInput:
                            id: inputcontent2
                            multiline: False
                            font_size: sp(23)

                        Button:
                            size_hint: 0.8, 1
                            text: 'clear tab'
                            background_color: (1, 0, 0, 1)
                            on_release: root.clear_tab()
                            font_size: sp(25)

                    ListWidget:
                        id: outputcontent2
                        viewclass: 'SelectableBox'
                        orientation: 'vertical'

                        RecycleBoxLayout:
                            default_size: None, dp(56)
                            default_size_hint: 1, None
                            size_hint_y: None
                            height: self.minimum_height
                            orientation: 'vertical'

            TabbedPanelItem:
                text: 'Carrefour'
                font_size: sp(25)
                canvas.after:
                    Color:
                        rgba: (0.2, 0.6, 1, 0.2) if self.state == 'down' else (0.7, 0.7, 0.7, 0.2)
                    Rectangle:
                        pos: self.pos
                        size: self.size

                BoxLayout:
                    orientation:'vertical'
                    BoxLayout:
                        size_hint: 1, 0.1
                        Button:
                            id: inputbutton3
                            size_hint: 0.3, 1
                            text: 'add'
                            background_color: (0, 1, 0, 1)
                            on_release: root.add_item()
                            font_size: sp(23)

                        TextInput:
                            id: inputcontent3
                            multiline: False
                            font_size: sp(23)

                        Button:
                            size_hint: 0.8, 1
                            text: 'clear tab'
                            background_color: (1, 0, 0, 1)
                            on_release: root.clear_tab()
                            font_size: sp(25)

                    ListWidget:
                        id: outputcontent3
                        viewclass: 'SelectableBox'
                        orientation: 'vertical'

                        RecycleBoxLayout:
                            default_size: None, dp(56)
                            default_size_hint: 1, None
                            size_hint_y: None
                            height: self.minimum_height
                            orientation: 'vertical'
                            
            TabbedPanelItem:
                text: 'Moemoe'
                font_size: sp(25)
                canvas.after:
                    Color:
                        rgba: (0.2, 0.6, 1, 0.2) if self.state == 'down' else (0.7, 0.7, 0.7, 0.2)
                    Rectangle:
                        pos: self.pos
                        size: self.size

                BoxLayout:
                    orientation:'vertical'
                    BoxLayout:
                        size_hint: 1, 0.1
                        Button:
                            id: inputbutton4
                            size_hint: 0.3, 1
                            text: 'add'
                            background_color: (0, 1, 0, 1)
                            on_release: root.add_item()
                            font_size: sp(23)

                        TextInput:
                            id: inputcontent4
                            multiline: False
                            font_size: sp(23)

                        Button:
                            size_hint: 0.8, 1
                            text: 'clear tab'
                            background_color: (1, 0, 0, 1)
                            on_release: root.clear_tab()
                            font_size: sp(25)

                    ListWidget:
                        id: outputcontent4
                        viewclass: 'SelectableBox'
                        orientation: 'vertical'

                        RecycleBoxLayout:
                            default_size: None, dp(56)
                            default_size_hint: 1, None
                            size_hint_y: None
                            height: self.minimum_height
                            orientation: 'vertical'
        BoxLayout:
            size_hint: 1, 0.1 
            Button:
                size_hint: 0.5, 1
                text: "Shopping"
                font_size: sp(23)
            Button:
                size_hint: 0.5, 1
                text: "Cart"   
                font_size: sp(23)
                on_release: 
                    app.root.current = "second"
                    app.root.transition.direction = 'left'
            Button:
                size_hint: 0.5, 1
                text: "Expenses"
                font_size: sp(23)   
                on_release:
                    app.root.current = "third"
                    app.root.transition.direction = 'left'


<SecondScreen>:
    name: "second"
    outputcontent:outputcontent
    BoxLayout:
        orientation: 'vertical'
        Label:
            text: 'Cart List'
            size_hint: 1, 0.1
            font_size: sp(32)
        Button:
            text: 'clear cart'
            size_hint: 1, 0.1
            background_color: (1, 0, 0, 1)
            font_size: sp(23)
            on_release: root.on_clear_cart_click()

        ListWidget:
            id: outputcontent
            viewclass: 'SelectableBoxSecondScreen'
            orientation: 'vertical'

            RecycleBoxLayout:
                default_size: None, sp(50)
                default_size_hint: 1, None
                size_hint_y: None
                height: self.minimum_height
                orientation: 'vertical'
        BoxLayout:
            size_hint: 1, 0.1
            Button:
                size_hint: 0.5, 1
                text: "Shopping"
                font_size: sp(23)
                on_release: 
                    app.root.current = "first" 
                    app.root.transition.direction = 'right'   
            Button:
                size_hint: 0.5, 1
                text: "Cart"
                font_size: sp(23)  
            Button:
                size_hint: 0.5, 1
                text: "Expenses"
                font_size: sp(23)
                on_release:
                    app.root.current = "third"
                    app.root.transition.direction = 'left'

<ThirdScreen>
    name: 'third'
    expensescontent:expensescontent
    BoxLayout:
        orientation: 'vertical'
        Label: 
            text: 'Expenses Screen'
            size_hint: 1, 0.1
            font_size: sp(32) 
        Button:
            size_hint: 1, 0.1
            font_size: sp(23)
            text: 'Add expense'
            background_color: (0, 1, 0, 1)
            on_release:
                app.root.current = 'fourth'
        ListWidget:
            id: expensescontent
            viewclass: 'SelectableBoxThirdScreen'
            orientation: 'vertical'

            RecycleBoxLayout:
                default_size: None, sp(50)
                default_size_hint: 1, None
                size_hint_y: None
                height: self.minimum_height
                orientation: 'vertical'
        BoxLayout:
            size_hint: 1, 0.1
            Button:
                size_hint: 0.5, 1
                text: "Shopping"
                font_size: sp(23)                
                on_release: 
                    app.root.current = "first" 
                    app.root.transition.direction = 'right'   
            Button:
                size_hint: 0.5, 1
                text: "Cart"
                font_size: sp(23)
                on_release: 
                    app.root.current = "second" 
                    app.root.transition.direction = 'right'                
            Button:
                size_hint: 0.5, 1
                text: "Expenses"
                font_size: sp(23)

<FourthScreen>:
    name: "fourth" 
    img: img  
    BoxLayout:
        orientation: 'vertical' 
        Button:
            text: 'Choose Image'
            size_hint_y: None
            height: '48sp'
            font_size: sp(23)
            on_release: root.select_file()
        Image:
            id: img
            source: ''
        Button:
            text: 'Analyze and add'
            size_hint: 1, 0.1 
            font_size: sp(23)
            on_release: 
                app.root.current = "third" 
                app.root.transition.direction = 'right'      
                root.analyze_photo()  

<FifthScreen>:
    name: "fifth"
    receiptitems:receiptitems
    BoxLayout:
        orientation: 'vertical'
        BoxLayout:
            size_hint: 1, 0.1
            Button:
                size_hint: 0.2, 1
                text: 'Back'
                background_color: (1, 0, 0, 1)
                on_release:
                    app.root.current = 'third'
                    app.root.transition.direction = 'right'    
            Label: 
                size_hint: 0.8, 1
                text: 'Receipt details'
                font_size: sp(28)
              
            Label:
                size_hint: 0.2, 1
           
        Label:
            size_hint: 1, 0.1
            text: root.company_name
            font_size: sp(21)
                
        Label:
            size_hint: 1, 0.1
            text: root.date_of_purchase
            font_size: sp(21)

        Label:
            size_hint: 1, 0.1
            text: 'Bought items:'
            font_size: sp(21)

        BoxLayout:
            size_hint_y: 0.1
            Label:
                text: 'Name'
                font_size: sp(18)
                size_hint: 0.6, 1
            Label:
                text: 'Qt'
                font_size: sp(18)
                size_hint: 0.1, 1
            Label:
                text: 'Price/#'
                font_size: sp(18)
                size_hint: 0.2, 1
        ListWidget3C:
            id: receiptitems
            viewclass: 'SelectableBoxFifthScreen'
            orientation: 'vertical'

            RecycleBoxLayout:
                default_size: None, dp(56)
                default_size_hint: 1, None
                size_hint_y: None
                height: self.minimum_height
                orientation: 'vertical'

        Label:
            size_hint: 1, 0.3
            text: root.total_amount
            font_size: sp(21)

        






   




            




    

        

 

